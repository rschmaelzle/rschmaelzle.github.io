<!-- 1. The Data Source (Hidden) -->
<bibtex src="{{ .Get "src" }}"></bibtex>

<!-- 2. The Output Display (This is where the list appears) -->
<div id="bibtex_display">
    
    <!-- The Structure: Groups items by Year -->
    <div class="bibtex_structure">
        <div class="group year" style="margin-bottom: 40px;">
            
            <!-- The Year Header -->
            <div style="font-size: 1.5rem; font-weight: bold; border-bottom: 2px solid #eee; margin-bottom: 15px; padding-bottom: 5px;">
                <i class="fas fa-calendar-alt"></i> 
                <!-- The JS inserts the year number right here automatically -->
            </div>
            
            <!-- The list of papers for that year -->
            <div class="templates"></div>
        
        </div>
    </div>

    <!-- The Template: How one single paper looks -->
    <!-- This is hidden until the JS clones it into the structure above -->
    <div class="bibtex_template" style="display: none;">
        <div style="margin-bottom: 15px; padding-left: 10px; border-left: 3px solid #eee;">
            
            <div style="font-size: 1rem; line-height: 1.6;">
                <span class="author" style="font-weight: bold; color: var(--primary);"></span> 
                (<span class="year"></span>). 
                <span class="title" style="font-style: italic;"></span>. 
                <span class="journal"></span>
                <span class="booktitle"></span>.
            </div>

            <div style="margin-top: 5px; font-size: 0.9rem;">
                <!-- Conditional Links -->
                <span class="if url"> 
                    <a class="url" href="#" target="_blank" style="text-decoration: none;">[LINK]</a> 
                </span>
                <span class="if pdf"> 
                    <a class="pdf" href="#" target="_blank" style="text-decoration: none;">[PDF]</a> 
                </span>
                <span class="if doi"> 
                    <a class="doi" href="#" target="_blank" style="text-decoration: none;">[DOI]</a> 
                </span>
                <span class="if code"> 
                    <a class="code" href="#" target="_blank" style="text-decoration: none;">[CODE]</a> 
                </span>
            </div>

        </div>
    </div>

</div>

<!-- 3. Load the Script -->
<script src="https://cdn.jsdelivr.net/gh/pcooksey/bibtex-js@1.0.0/src/bibtex_js.js"></script>

<!-- 4. Force Visibility (The Anti-Flash CSS) -->
<style>
    #bibtex_display {
        display: block !important;
        opacity: 1 !important;
        visibility: visible !important;
    }
    .bibtex_structure {
        display: block !important;
    }
</style>